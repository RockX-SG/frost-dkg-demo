# DKG Operator Node - installation

### Environment variables for .env file
```
NODE_OPERATOR_ID=1
NODE_ADDR=0.0.0.0:8080
NODE_BROADCAST_ADDR=<public ip or public address>
MESSENGER_SRV_ADDR=https://dkg-messenger.rockx.com
KEYSTORE_FILE_PATH=/keys/<keystore file name>
KEYSTORE_PASSWORD=password
USE_HARDCODED_OPERATORS=false
```

> Note: keep USE_HARDCODED_OPERATORS=false to use SSV operator registry instead of hardcoded values


### Docker command to run the containers

#### Keystore file

To proceed, create a new folder called `keystorefiles` in this location, and move your keystore file there. This file contains the private key for the eth1 address of your SSV Node operator. It's important to ensure that you're using the keystore file corresponding to the eth address of the node operator's owner. For example, if the SSV node operator's eth address is 2d618a45796936b1b7aeb87d01ee70e09254487d, then the keystore file used for the DKG node must be the same as the one shown below.

```
ls keystorefiles/
UTC--2023-03-31T17-18-30.220964000Z--2d618a45796936b1b7aeb87d01ee70e09254487d
```

#### Environment Variables file

Create a folder `env` and store your env file here

```
ls env/
operator.1.env
```

#### Pull your docker image from GCP container registry
```
docker pull asia-southeast1-docker.pkg.dev/rockx-mpc-lab/rockx-dkg/rockx-dkg-node:latest
```

#### Run the container with the env file and the keystore folder
```
docker run -d --name operator-node -v $PWD/keystorefiles:/keys --env-file ./env/operator.1.env -p 8080:8080 asia-southeast1-docker.pkg.dev/rockx-mpc-lab/rockx-dkg/rockx-dkg-node
```

### Creating/Importing keystore files

Keystore files (version 3) for ethereum accounts can be generated by using a tool called `clef`. The documentation and installation instructions for clef can be found here 
> https://geth.ethereum.org/docs/tools/clef/introduction

#### Creating a new key
```
> clef newaccount --keystore <path>

Please enter a password for the new account to be created:
> <password>

------------
INFO [10-28|16:19:09.156] Your new key was generated       address=0x5e97870f263700f46aa00d967821199b9bc5a120
WARN [10-28|16:19:09.306] Please backup your key file      path=/home/user/go-ethereum/data/keystore/UTC--2022-10-28T15-19-08.000825927Z--5e97870f263700f46aa00d967821199b9bc5a120
WARN [10-28|16:19:09.306] Please remember your password!
Generated account 0x5e97870f263700f46aa00d967821199b9bc5a120

Show all

```

#### Importing existing key

```
# keyfile.txt contains unencrypted private key in hex format
> clef importraw --keystore <path> keyfile.txt

## Password

Please enter a password for the imported account
>
-----------------------
## Password

Please repeat the password you just entered
>
-----------------------
## Info
Key imported:
  Address 0x5e97870f263700f46aa00d967821199b9bc5a120
  Keystore file: go-ethereum/data/keystore/UUTC--2022-10-28T15-19-08.000825927Z--5e97870f263700f46aa00d967821199b9bc5a120
```



